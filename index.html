<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SGkasir - Final</title>

  <!-- bootstrap + icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

  <!-- custom -->
  <link rel="stylesheet" href="style.css">

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icon-192.png" />
</head>
<body>

  <!-- HEADER -->
  <nav class="navbar header bg-dark text-white">
    <div class="container-fluid d-flex align-items-center">
      <button class="btn btn-ghost me-2" data-bs-toggle="offcanvas" data-bs-target="#sidebar">
        <i class="bi bi-list" style="font-size:1.25rem;color:var(--accent)"></i>
      </button>

      <div class="brand d-flex align-items-center">
        <img id="brandLogo" src="logo.png" alt="logo" width="36" height="36" class="me-2"/>
        <div>
          <div class="brand-title">Nama Konter</div>
          <div class="brand-sub">SGkasir</div>
        </div>
      </div>

      <div class="ms-auto d-flex align-items-center gap-2">
        <button id="themeToggle" class="btn btn-ghost" title="Toggle theme">
          <i id="themeIcon" class="bi bi-moon" style="color:var(--accent)"></i>
        </button>
      </div>
    </div>
  </nav>

  <!-- SIDEBAR -->
  <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebar">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title">Menu</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
      <ul class="nav flex-column">
        <li class="nav-item"><a class="nav-link" href="javascript:void(0)" onclick="showSection('transaksi')">Transaksi</a></li>
        <li class="nav-item"><a class="nav-link" href="javascript:void(0)" onclick="showSection('pemasukan')">Pemasukan</a></li>
        <li class="nav-item"><a class="nav-link" href="javascript:void(0)" onclick="showSection('pengeluaran')">Pengeluaran</a></li>
        <li class="nav-item"><a class="nav-link" href="javascript:void(0)" onclick="showSection('saldo')">Saldo Akun</a></li>
        <li class="nav-item"><a class="nav-link" href="javascript:void(0)" onclick="showSection('stok')">Stok Barang</a></li>
        <li class="nav-item"><a class="nav-link" href="javascript:void(0)" onclick="showSection('hutang')">Hutang / Piutang</a></li>
        <li class="nav-item"><a class="nav-link" href="javascript:void(0)" onclick="showSection('audit')">Audit Stok</a></li>
        <li class="nav-item"><a class="nav-link" href="javascript:void(0)" onclick="showSection('pengaturan')">Pengaturan</a></li>
      </ul>
    </div>
  </div>

  <!-- MAIN -->
  <main class="container mt-3 mb-5">
    <!-- TRANSAKSI -->
    <section id="transaksi" class="page active">
      <div class="card p-3 mb-3">
        <div class="d-flex align-items-center gap-3 mb-2">
          <h5 class="mb-0">Transaksi</h5>
          <span class="badge bg-orange" id="saldoMini">Saldo: Rp 0</span>
        </div>

        <div class="row gx-2">
          <div class="col-12 col-md-6 mb-2">
            <label class="form-label small">Kategori</label>
            <select id="jenisTransaksi" class="form-select" onchange="onJenisChange()">
              <option value="Pulsa">Pulsa</option>
              <option value="Kuota">Kuota</option>
              <option value="PPOB">PPOB</option>
              <option value="Aksesoris">Aksesoris</option>
              <option value="E-Money">E-Money</option>
              <option value="Transfer">Transfer</option>
              <option value="Tarik Tunai">Tarik Tunai</option>
            </select>
          </div>

          <div class="col-12 col-md-6 mb-2">
            <label class="form-label small">Keterangan</label>
            <input id="namaProduk" class="form-control" placeholder="Nama / detail">
          </div>

          <div class="col-6 col-md-4 mb-2">
            <label class="form-label small">Nominal / Harga (Rp)</label>
            <input id="hargaProduk" type="number" class="form-control" placeholder="0">
          </div>

          <div class="col-6 col-md-4 mb-2" id="adminWrap" style="display:none;">
            <label class="form-label small">Biaya Admin (opsional)</label>
            <input id="adminBiaya" type="number" class="form-control" placeholder="0">
          </div>

          <div class="col-6 col-md-4 mb-2">
            <label class="form-label small">Pilih Akun</label>
            <select id="akunTransaksi" class="form-select"></select>
          </div>

          <div class="col-12 d-grid mt-2">
            <button class="btn btn-orange" onclick="simpanTransaksi()">ðŸ’¾ Simpan Penjualan</button>
          </div>
        </div>
      </div>
    </section>

    <!-- HISTORY -->
    <section id="history" class="page">
      <div class="card p-3 mb-3">
        <div class="d-flex justify-content-between mb-2">
          <h5 class="mb-0">History</h5>
          <div class="btn-group">
            <button class="btn btn-outline-dark" onclick="exportCSV()">Export CSV</button>
            <button class="btn btn-outline-dark" onclick="downloadJSON()">Backup JSON</button>
          </div>
        </div>

        <div class="mb-2">
          <textarea id="catatanShare" class="form-control" placeholder="Catatan untuk share/print" rows="2"></textarea>
        </div>

        <div class="d-flex gap-2 mb-2">
          <button class="btn btn-dark flex-fill" onclick="printHistory()">Print</button>
          <button class="btn btn-info flex-fill" onclick="shareTXT()">Share TXT</button>
          <button class="btn btn-warning flex-fill" onclick="sharePNG()">Share PNG</button>
        </div>

        <ul id="historyList" class="list-group"></ul>
      </div>
    </section>

    <!-- REKAP -->
    <section id="rekap" class="page">
      <div class="card p-3 mb-3">
        <h5>Rekap</h5>
        <div class="row">
          <div class="col-6">
            <p class="mb-1">Omzet</p>
            <h4 id="rekapOmzet">Rp 0</h4>
          </div>
          <div class="col-6">
            <p class="mb-1">Total Saldo</p>
            <h4 id="rekapSaldo">Rp 0</h4>
          </div>
        </div>
        <hr/>
        <h6>Saldo Per Akun</h6>
        <ul id="akunList" class="list-group"></ul>
      </div>
    </section>

    <!-- PEMASUKAN -->
    <section id="pemasukan" class="page">
      <div class="card p-3 mb-3">
        <h5>Pemasukan Manual</h5>
        <input id="jumlahPemasukan" type="number" class="form-control mb-2" placeholder="Jumlah (Rp)">
        <input id="ketPemasukan" class="form-control mb-2" placeholder="Keterangan (opsional)">
        <button class="btn btn-success w-100" onclick="tambahPemasukan()">Simpan Pemasukan</button>
      </div>
    </section>

    <!-- PENGELUARAN -->
    <section id="pengeluaran" class="page">
      <div class="card p-3 mb-3">
        <h5>Pengeluaran Manual</h5>
        <input id="jumlahPengeluaran" type="number" class="form-control mb-2" placeholder="Jumlah (Rp)">
        <input id="ketPengeluaran" class="form-control mb-2" placeholder="Keterangan (opsional)">
        <button class="btn btn-danger w-100" onclick="tambahPengeluaran()">Simpan Pengeluaran</button>
      </div>
    </section>

    <!-- SALDO AKUN -->
    <section id="saldo" class="page">
      <div class="card p-3 mb-3">
        <h5>Saldo Akun</h5>
        <table class="table">
          <thead><tr><th>Akun</th><th>Saldo</th></tr></thead>
          <tbody id="saldoTable"></tbody>
        </table>
        <input id="namaAkunBaru" class="form-control mb-2" placeholder="Nama Akun (Contoh: BCA)">
        <input id="saldoAwal" type="number" class="form-control mb-2" placeholder="Saldo Awal (Rp)">
        <button class="btn btn-primary w-100" onclick="tambahAkun()">Tambah Akun</button>
      </div>
    </section>

    <!-- STOK -->
    <section id="stok" class="page">
      <div class="card p-3 mb-3">
        <h5>Stok Barang</h5>
        <table class="table">
          <thead><tr><th>Nama</th><th>Stok</th><th>Harga</th></tr></thead>
          <tbody id="stokTable"></tbody>
        </table>
        <input id="namaBarang" class="form-control mb-2" placeholder="Nama Barang">
        <input id="stokJumlah" type="number" class="form-control mb-2" placeholder="Jumlah">
        <input id="stokHarga" type="number" class="form-control mb-2" placeholder="Harga">
        <button class="btn btn-primary w-100" onclick="tambahStok()">Tambah Barang</button>
      </div>
    </section>

    <!-- HUTANG -->
    <section id="hutang" class="page">
      <div class="card p-3 mb-3">
        <h5>Hutang / Piutang</h5>
        <table class="table">
          <thead><tr><th>Nama</th><th>Jumlah</th><th>Tipe</th></tr></thead>
          <tbody id="hutangTable"></tbody>
        </table>
        <input id="namaHutang" class="form-control mb-2" placeholder="Nama">
        <input id="jumlahHutang" type="number" class="form-control mb-2" placeholder="Jumlah">
        <select id="tipeHutang" class="form-select mb-2">
          <option>Hutang</option><option>Piutang</option>
        </select>
        <button class="btn btn-primary w-100" onclick="tambahHutang()">Simpan</button>
      </div>
    </section>

    <!-- AUDIT -->
    <section id="audit" class="page">
      <div class="card p-3 mb-3">
        <h5>Audit Stok</h5>
        <div id="auditResult"></div>
        <button class="btn btn-warning w-100" onclick="auditStok()">Cek Audit</button>
      </div>
    </section>

    <!-- PENGATURAN -->
    <section id="pengaturan" class="page">
      <div class="card p-3 mb-3">
        <h5>Pengaturan</h5>
        <label class="form-label small">Catatan & Logo untuk print/share</label>
        <textarea id="catatanPengaturan" class="form-control mb-2" rows="2" placeholder="Alamat / Nomor HP / Catatan"></textarea>
        <label class="form-label small">Logo (nama file: logo.png) di root repo</label>
        <div class="d-grid gap-2 mt-2">
          <button class="btn btn-danger" onclick="resetData()">Reset Semua Data</button>
        </div>
      </div>
    </section>
  </main>

  <!-- BOTTOM NAV -->
  <nav class="navbar fixed-bottom bottom-nav bg-white border-top">
    <div class="d-flex w-100">
      <button class="flex-fill nav-btn" onclick="showSection('transaksi')"><i class="bi bi-wallet2"></i><div>Transaksi</div></button>
      <button class="flex-fill nav-btn" onclick="showSection('history')"><i class="bi bi-clock-history"></i><div>History</div></button>
      <button class="flex-fill nav-btn" onclick="showSection('rekap')"><i class="bi bi-graph-up"></i><div>Rekap</div></button>
    </div>
  </nav>

  <!-- libs -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <!-- app -->
  <script src="app.js"></script>

  <!-- register service worker -->
  <script>
    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('service-worker.js').catch(()=>{});
    }
  </script>
</body>
</html>